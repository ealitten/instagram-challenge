<div class="posts-wrapper row">
<h2 class="main-title"> Railstagram</h2>
  <% @posts.each do |post| %>

    <div class="post">
      <div class="post-head">
        <div class="name"><%= User.find(post.user_id).email.split("@")[0] %></div>
        <% if get_user_by_id(post.user_id) == current_user %>
        <div class="edit-links">
          <%= link_to "Edit", edit_post_path(post), id: "edit-post-#{post.id}" %> | 
          <%= link_to "Remove", post_path(post),
            method: :delete,
            id: "delete-post-#{post.id}",
            data: { confirm: "Are you sure?" } %> 
        </div>
        <% end %>
      </div>

      <% if post.image? %>
        <div class="image-block">
          <%= image_tag post.image.url, class: "image-centred" %>
        </div>
      <% end %>

      <div class="caption">
        <% if current_user %>
          <% if current_user_has_liked_post(post) %>
          <%= link_to "💔", post_like_path(post.id, get_like(post)), method: :delete, id: "delete-like-#{get_like(post).id}" %>
          <% else %>
            <%= link_to "❤️", post_likes_path(post.id), method: :post, id: "like-post-#{post.id}" %>
          <% end %>
        <% end %>

        <p class="like-count">
          <strong><%= post.likes.count%> likes</strong>
        </p>

        <p>
          <%= post.description %>
        </p>

        <div id="post-<%= post.id %>-comments">
          <%= render 'comments', post: post %>
        </div>

        <% if current_user %>
          <p>
            <%= form_with(model: [post, post.comments.build]) do |form| %>
            <%= form.text_field :body, id: "comment-body-on-post-#{post.id}" %>
            <%= form.submit "Comment", id: "submit-comment-on-post-#{post.id}" %>
            <% end %>
          </p>
        <% end %>
      </div>
    </div>
  <% end %>
</div>